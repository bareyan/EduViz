# =============================================================================
# EduViz Backend - Advanced Tuning Template
# =============================================================================
# This file lists optional tuning knobs.
# Most teams should only use .env.example and keep code defaults for these.

# -----------------------------------------------------------------------------
# API / Runtime behavior
# -----------------------------------------------------------------------------
LOG_LEVEL=INFO
LOG_FILE=
JSON_LOGS=false
PIPELINE_LOG_FILE=logs/animation_pipeline.jsonl
ENV=production

# Non-upload request max body size (bytes)
MAX_REQUEST_BODY_BYTES=2097152

# Simple in-memory per-IP rate limit middleware
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=600
RATE_LIMIT_WINDOW_SECONDS=60

# Auth session settings
AUTH_SECRET=replace_with_long_random_secret
AUTH_SESSION_MAX_AGE_SECONDS=604800
AUTH_COOKIE_SECURE=false
# Extra public (unauthenticated) exact paths, comma-separated
AUTH_OPEN_PATHS=

# -----------------------------------------------------------------------------
# Storage retention / cleanup
# -----------------------------------------------------------------------------
OUTPUT_KEEP_ONLY_FINAL=true
OUTPUT_CLEANUP_ENABLED=true
OUTPUT_CLEANUP_INTERVAL_MINUTES=60
OUTPUT_CLEANUP_MAX_DELETIONS=100

# Output retention (hours)
OUTPUT_RETENTION_HOURS=168
FAILED_OUTPUT_RETENTION_HOURS=48
ORPHAN_OUTPUT_RETENTION_HOURS=24
JOB_METADATA_RETENTION_HOURS=168

# Upload retention
UPLOAD_CLEANUP_ENABLED=true
UPLOAD_RETENTION_HOURS=168
UPLOAD_CLEANUP_MAX_DELETIONS=100

# Job manager in-memory cache size
JOB_MANAGER_CACHE_LIMIT=200

# Script generation PDF strategy:
# false (default): send original PDF + page-range guidance (faster)
# true: physically slice per-section PDFs before LLM calls (slower, optional)
ENABLE_SECTION_PDF_SLICES=false
# Only slice PDFs when total_pages >= this value (helps avoid 1-2 page over-splitting)
SECTION_PDF_SLICE_MIN_PAGES=3

# Overview mode duration/structure controls:
# Used by overview_generator.py to target longer "quick overview" videos.
OVERVIEW_MIN_DURATION_SECONDS=180
OVERVIEW_MAX_DURATION_SECONDS=420
OVERVIEW_MIN_SECTIONS=5
OVERVIEW_MAX_SECTIONS=8
OVERVIEW_SECTION_MIN_WORDS=80
OVERVIEW_SECTION_MAX_WORDS=170
OVERVIEW_CONSTRAINT_RETRY_COUNT=1

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# App log rotation
LOG_MAX_BYTES=20971520
LOG_BACKUP_COUNT=5

# LLM log controls
LLM_LOG_MAX_PROMPT_LENGTH=4000
LLM_LOG_MAX_RESPONSE_LENGTH=4000
LLM_LOG_MAX_SYSTEM_LENGTH=500
LLM_LOG_MAX_BYTES=20971520
LLM_LOG_BACKUP_COUNT=5

# Optional dedicated LLM log files
LLM_LOG_FILE=
LLM_LOG_FULL_FILE=
LLM_LOG_CONSOLE=true
